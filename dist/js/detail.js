"use strict";function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),i.forEach(function(e){_defineProperty(t,e,n[e])})}return t}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}require(["require-config"],function(){require(["url","template","header","footer"],function(e,i){new(function(){function t(){var e=this;_classCallCheck(this,t),this.ajx().then(function(){e.init()})}return _createClass(t,[{key:"ajx",value:function(){var i=this;return new Promise(function(t){var n=Number(location.search.slice(4));$.ajax({url:e.baseUrl+"detail/get",type:"get",data:{id:n},success:function(e){i.render(e.res_body.detailgoods,n),t()},"data-type":"json"})})}},{key:"render",value:function(e,t){var n=(e=e.filter(function(e){return e.id===t})[0]).images;this.good=e,$("#detailContainer").html(i("detail-template",{good:e,images:n}))}},{key:"init",value:function(){this.plus=$("#plus"),this.minus=$("#minus"),this.numInput=$("#num"),this.purchaseNow=$("#purchaseNow"),this.addShopBag=$("#addShopBag"),this.num=Number(this.numInput.val()),this.money=Number($("#subtotal").html()),this.bindEvents()}},{key:"bindEvents",value:function(){var t=this;this.plus.on("click",function(){t.numInput.val(++t.num),$("#subtotal").html(t.num*t.money)}),this.minus.on("click",function(){0==--t.num&&(t.num=1),t.numInput.val(t.num),$("#subtotal").html((t.num*t.money).toFixed(2))}),this.numInput.on("keyup",function(){var e=null;t.num=Number(t.numInput.val()),e=t.num*t.money,$("#subtotal").html(e.toFixed(2))}),this.addShopBag.on("click",function(){t.addCart()})}},{key:"addCart",value:function(){var e=localStorage.getItem("cart"),t=this.num,n="true",i="glyphicon glyphicon-ok check ok";if(e){e=JSON.parse(e);var r=-1,o=this.addShopBag.attr("data-id");e.some(function(e,t){return r=t,e.id===Number(o)})&&(t+=e[r].num,e.splice(r,1)),e.unshift(_objectSpread({},this.good,{num:t,check:n,cls:i}))}else e=[_objectSpread({},this.good,{num:t,check:n,cls:i})];localStorage.setItem("cart",JSON.stringify(e))}}]),t}())})});